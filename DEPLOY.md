# üöÄ –î–µ–ø–ª–æ–π Food App

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- –°–µ—Ä–≤–µ—Ä —Å Ubuntu/Debian
- SSH –¥–æ—Å—Ç—É–ø –∫ —Å–µ—Ä–≤–µ—Ä—É
- –î–æ–º–µ–Ω `food.nitive.me` (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)

## –ë—ã—Å—Ç—Ä—ã–π –¥–µ–ø–ª–æ–π

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É –≤–∞—Å –µ—Å—Ç—å:
- SSH –∫–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–µ—Ä–≤–µ—Ä—É
- Google OAuth credentials (–¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ GitHub Secrets

–î–æ–±–∞–≤—å—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Å–µ–∫—Ä–µ—Ç—ã –≤ GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (—Å–º. `GITHUB_SECRETS.md`):

```bash
SERVER_HOST = 138.68.124.16
SERVER_USER = root
SERVER_SSH_KEY = –≤–∞—à_ssh_–∫–ª—é—á
SERVER_PORT = 22
DOMAIN = food.nitive.me
GOOGLE_CLIENT_ID = –≤–∞—à_google_client_id
GOOGLE_CLIENT_SECRET = –≤–∞—à_google_client_secret
JWT_SECRET = –≤–∞—à_jwt_—Å–µ–∫—Ä–µ—Ç
```

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π

–ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ–∫—Ä–µ—Ç–æ–≤:
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π** - –ø—Ä–∏ –∫–∞–∂–¥–æ–º push –≤ –≤–µ—Ç–∫—É `main`
- **–†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π** - –≤ Actions ‚Üí Deploy to Production ‚Üí Run workflow

### 4. –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π (–ª–æ–∫–∞–ª—å–Ω–æ)

```bash
# –î–µ–ø–ª–æ–π –Ω–∞ IP –∞–¥—Ä–µ—Å
./deploy.sh 138.68.124.16

# –î–µ–ø–ª–æ–π —Å –¥–æ–º–µ–Ω–æ–º (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–æ–∏—Ç HTTPS)
./deploy.sh 138.68.124.16 food.nitive.me
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é Docker Compose –∏ –≤–∫–ª—é—á–∞–µ—Ç:

- **PostgreSQL** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **Node.js App** - –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- **Caddy** - –≤–µ–±-—Å–µ—Ä–≤–µ—Ä —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º HTTPS

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
/opt/food-app/
‚îú‚îÄ‚îÄ docker-compose.yml    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Docker
‚îú‚îÄ‚îÄ Dockerfile           # –û–±—Ä–∞–∑ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ Caddyfile           # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Caddy
‚îú‚îÄ‚îÄ .env.production     # –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îî‚îÄ‚îÄ src/                # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
```

## –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
```bash
ssh root@138.68.124.16 'cd /opt/food-app && docker-compose logs -f'
```

### –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
```bash
ssh root@138.68.124.16 'cd /opt/food-app && docker-compose restart'
```

### –û—Å—Ç–∞–Ω–æ–≤–∫–∞
```bash
ssh root@138.68.124.16 'cd /opt/food-app && docker-compose down'
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
```bash
./deploy.sh 138.68.124.16 food.nitive.me
```

## –î–æ—Å—Ç—É–ø

–ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É:
- **HTTPS**: https://food.nitive.me
- **HTTP**: http://138.68.124.16 (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ HTTPS)

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π HTTPS —Å Let's Encrypt
- –ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- –ù–µ–ø—Ä–∏–≤–∏–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Å–µ–∫—Ä–µ—Ç–æ–≤

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
```bash
ssh root@138.68.124.16 'cd /opt/food-app && docker-compose ps'
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
```bash
ssh root@138.68.124.16 'cd /opt/food-app && docker-compose logs --tail=50'
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
```bash
ssh root@138.68.124.16 'cd /opt/food-app && docker-compose exec postgres psql -U food_user -d food_app'
```

## –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
```bash
ssh root@138.68.124.16 'cd /opt/food-app && docker-compose exec app npx prisma db push'
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å –º–∏–≥—Ä–∞—Ü–∏—è–º–∏
```bash
ssh root@138.68.124.16 'cd /opt/food-app && docker-compose exec app npx prisma migrate reset'
```

### –ü—Ä–æ–±–ª–µ–º—ã —Å SSL
```bash
ssh root@138.68.124.16 'cd /opt/food-app && docker-compose logs caddy'
```

## –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
```bash
ssh root@138.68.124.16 'cd /opt/food-app && docker-compose exec postgres pg_dump -U food_user food_app > backup.sql'
```

### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
```bash
ssh root@138.68.124.16 'cd /opt/food-app && docker-compose exec -T postgres psql -U food_user -d food_app < backup.sql'
```
